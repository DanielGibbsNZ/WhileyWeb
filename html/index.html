<!DOCTYPE html>
<html lang="en">
<head>
<title>Whiley on the Web!</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/codemirror.css">
<script type="text/javascript" src="js/jquery.js"></script>
<script src="js/codemirror.js"></script>
<script src="src/whiley.js"></script>

<script type="text/javascript">
function compile() {
  var console = document.getElementById("console");
  var request = { code: editor.getValue() };
  $.post("${ROOT_URL}/compiler",request, function(response) {
     errors = $.parseJSON(response);
     $("#compiling").css("visibility", "hidden");
     for(var i=0;i!=errors.length;++i) {
         var error = errors[i];
         var start = {line: error.line-1, ch: error.start};
         var end = {line: error.line-1, ch: error.end+1};
         editor.markText(start,end,{className: "errorMarker"});
     }
     console.value = response;
   });
  $("#compiling").css("visibility", "visible");
}
</script>

</head>
<body>
<div id="header">
</div>
<div id="container">
<div id="content">
<p>From this page, you can run Whiley programs in your browser!  For more on Whiley, visit <a href="http://whiley.org">whiley.org</a>.</p>

<section>
<textarea id="code">
// The absolute function
int abs(int x) ensures $ >= 0:
    if x >= 0:
        return x
    else:
        return -x
</textarea>
  <script>
    var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
    indentUnit: 4,
    lineNumbers: true,
    mode: "javascript"
    });
  </script>
  <button id="compile" type="button" onClick="compile()">Compile <img
  id="compiling" src="images/loading.gif"/></button>
  </section>
<textarea id="console">
</textarea>
</div>
</div>
</body>
</html>
